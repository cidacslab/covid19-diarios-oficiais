<!DOCTYPE html>
<html>
  <body>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <svg id="canvas"></svg>
    <script>
      // setting the data up
      data = [
        {
          x: "25%",
          y: "50%",
          r: "5%",
          c: "red",
        },
        {
          x: "50%",
          y: "50%",
          r: "5%",
          c: "green",
        },
        {
          x: "75%",
          y: "50%",
          r: "5%",
          c: "blue",
        },
      ];
      // selecting canvas
      var canvas = d3.select("#canvas");
      // bind data to the DOM
      // notice that we don't create the shapes yet
      // this only prepares d3 for the possibility of selecting circle elements
      // based on the data
      var circles = canvas.selectAll("circle").data(data);
      // this appends the circle ellements to the canvas
      circles
        .enter()
        // this method takes the selections and filter them that
        // only selection to new elements remain
        .append("circle")
        .attr("cx", function (d) {
          return d.x;
        })
        .attr("cy", function (d) {
          return d.y;
        })
        .attr("fill", function (d) {
          return d.c;
        })
        .attr("r", function (d) {
          return d.r;
        });
      // creating new data
      data[1].y = '75%'
      // adding new data
      data.push({
        x: '50%',
        y: '25%',
        r: '5%',
        c: 'magenta'})
      // tell d3 about the change
      var circles = canvas
        .selectAll('circle')
        .data(data);
      // tell d3 to add the new element
      circles
        // if you want to just update some elements you need to comment out
        // .enter and .append('')
        .enter()
        // this method takes the selections and filter them that
        // only selection to new elements remain
        .append('circle')
        .attr('cx', function(d) {
          return d.x;
        })
        .attr('cy', function(d) {
          return d.y;
        })
        .attr('fill', function(d) {
          return d.c;
        })
        .attr('r', 0)
        .transition().duration(1000)
        .attr('r', function(d){
          return d.r
        });
      // tell d3 to update the green circle
      circles
        .transition().duration(1000)
        .attr('cy', function(d) {
          return d.y;
        })
      // similar to the enter element there is an exit element
      // it filters the selection only to select elements which are bout to datums that no longer exists
      // this allow us to handle 'orpahn' elements
      // we can remove them from the canvas this way:
      // circles
      //  .exit()
      //  .remove()
      //
      // UNIQUELY IDENTIFYING DATUMS
      // it is possible to add unique ids to each data,
      // and d3 can use it to detect if an element has changed or not
    
    </script>
  </body>
</html>
